<!DOCTYPE html>
<html lang="tr">
<head>
    <meta ch                          <div class="admin-card" style="border-left: 5px solid #95a5a6;">
                    <h3>ğŸ“‹ Mevcut Durum</h3>    <div class="admin-card" style="border-left: 5px solid #34495e;">
                    <h3>ğŸ‘¤ MÃ¼ÅŸteri Bilgileri</h3>set="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MÃ¼ÅŸteri Paneli - AraÃ§ Takip Sistemi</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header class="admin-header" style="background: #3498db;">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h1>ğŸš— MÃ¼ÅŸteri Paneli</h1>
                <div>
                    <span id="customerName">HoÅŸ geldiniz!</span>
                    <a href="../index.html" style="color: white; margin-left: 20px; text-decoration: none;">
                        ğŸ  Ana Sayfa
                    </a>
                    <a href="../login.html" style="color: white; margin-left: 10px; text-decoration: none;">
                        ğŸšª Ã‡Ä±kÄ±ÅŸ
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <!-- AraÃ§ Bilgileri -->
            <section class="welcome-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>AraÃ§ Takip Bilgileri</h2>
                    <div style="text-align: right;">
                        <p><strong>Takip No:</strong> <span id="tracking-number" style="color: #4CAF50; font-weight: bold;">TK2025001</span></p>
                        <p><strong>KayÄ±t Tarihi:</strong> <span id="register-date">15.09.2025</span></p>
                    </div>
                </div>
                <p>AracÄ±nÄ±zÄ±n tamirhanedeki gÃ¼ncel durumunu aÅŸaÄŸÄ±dan takip edebilirsiniz.</p>
            </section>

            <!-- AraÃ§ ve MÃ¼ÅŸteri Bilgileri -->
            <div class="admin-cards">
                <div class="admin-card" style="border-left: 5px solid #3498db;">
                    <h3>ğŸš— AraÃ§ Bilgileri</h3>
                    <div style="text-align: left;">
                        <p><strong>Plaka:</strong> <span id="vehicle-plate">34 ABC 123</span></p>
                        <p><strong>Marka/Model:</strong> <span id="vehicle-model">Honda Civic 2018</span></p>
                        <p><strong>Sorun:</strong> <span id="vehicle-problem">Fren sistemi arÄ±zasÄ±</span></p>
                        <p><strong>GeliÅŸ Tarihi:</strong> <span id="arrival-date">15.09.2025</span></p>
                    </div>
                </div>

                <div class="admin-card" style="border-left: 5px solid #2196F3;">
                    <h3>ï¿½ MÃ¼ÅŸteri Bilgileri</h3>
                    <div style="text-align: left;">
                        <p><strong>Ad Soyad:</strong> <span id="customer-fullname">Ahmet YÄ±lmaz</span></p>
                        <p><strong>Telefon:</strong> <span id="customer-phone">0555 123 45 67</span></p>
                        <p><strong>E-posta:</strong> <span id="customer-email">ahmet@email.com</span></p>
                    </div>
                </div>

                <div class="admin-card" style="border-left: 5px solid #ff9800;">
                    <h3>ï¿½ Mevcut Durum</h3>
                    <div style="text-align: left;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <span id="status-icon" style="font-size: 2rem;">ğŸ”§</span>
                            <div>
                                <p style="margin: 0;"><strong>Durum:</strong> <span id="current-status" style="color: #ff9800; font-weight: bold;">OnarÄ±mda</span></p>
                                <p style="margin: 0; font-size: 0.9rem; color: #666;">Son GÃ¼ncelleme: <span id="last-update">21.09.2025 - 14:30</span></p>
                            </div>
                        </div>
                        <p><strong>Ä°ÅŸlem:</strong> <span id="current-operation">Fren balata deÄŸiÅŸimi</span></p>
                        <p><strong>Tahmini Teslim:</strong> <span id="estimated-delivery">22.09.2025</span></p>
                    </div>
                </div>
            </div>

            <!-- SÃ¼reÃ§ Takibi -->
            <section style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); margin-top: 30px; border: 1px solid #ecf0f1;">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“ˆ Ä°ÅŸlem SÃ¼reci</h2>
                
                <div class="process-timeline">
                    <div class="process-step completed">
                        <div class="step-icon">âœ…</div>
                        <div class="step-content">
                            <h4>KayÄ±t ve Kabul</h4>
                            <p>15.09.2025 - 09:30</p>
                            <small>AraÃ§ tamirhanede kabul edildi ve sisteme kaydedildi. Takip numarasÄ±: TK2025001</small>
                        </div>
                    </div>

                    <div class="process-step completed">
                        <div class="step-icon">âœ…</div>
                        <div class="step-content">
                            <h4>Ä°lk Muayene (Beklemede)</h4>
                            <p>15.09.2025 - 10:15</p>
                            <small>AracÄ±n genel durumu incelendi, fren sistemi sorunu tespit edildi. ParÃ§a sipariÅŸi verildi.</small>
                        </div>
                    </div>

                    <div class="process-step active">
                        <div class="step-icon">ğŸ”§</div>
                        <div class="step-content">
                            <h4>OnarÄ±m/BakÄ±m</h4>
                            <p>20.09.2025 - Devam ediyor</p>
                            <small>Fren balata deÄŸiÅŸimi ve fren hidroliÄŸi yenileme iÅŸlemi baÅŸladÄ±. ParÃ§alar geldi.</small>
                        </div>
                    </div>

                    <div class="process-step pending">
                        <div class="step-icon">â³</div>
                        <div class="step-content">
                            <h4>Kalite Kontrol</h4>
                            <p>Bekleniyor</p>
                            <small>OnarÄ±m tamamlandÄ±ktan sonra test sÃ¼rÃ¼ÅŸÃ¼ ve kalite kontrol yapÄ±lacak.</small>
                        </div>
                    </div>

                    <div class="process-step pending">
                        <div class="step-icon">âœ¨</div>
                        <div class="step-content">
                            <h4>Teslime HazÄ±r</h4>
                            <p>Bekleniyor</p>
                            <small>AraÃ§ teslim iÃ§in hazÄ±r olduÄŸunda SMS/telefon ile bildirilecek.</small>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Maliyet ve Ã–deme Bilgileri -->
            <section style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); margin-top: 30px; border: 1px solid #ecf0f1;">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">ğŸ’° Maliyet ve Ã–deme</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #333; margin-bottom: 15px;">ğŸ’µ Maliyet DetayÄ±</h4>
                        <p><strong>Ä°ÅŸÃ§ilik:</strong> <span id="labor-cost">800 â‚º</span></p>
                        <p><strong>Yedek ParÃ§a:</strong> <span id="parts-cost">450 â‚º</span></p>
                        <p style="border-top: 2px solid #ddd; padding-top: 10px; margin-top: 10px;"><strong>Toplam:</strong> <span id="total-cost" style="color: #2c3e50; font-size: 1.2rem;">1,250 â‚º</span></p>
                    </div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #333; margin-bottom: 15px;">ğŸ¦ Ã–deme Bilgisi</h4>
                        <p><strong>Ã–deme Durumu:</strong> <span id="payment-status" style="color: #ff9800; font-weight: bold;">Bekliyor</span></p>
                        <p><strong>Ã–deme Åekli:</strong> <span id="payment-method">Teslimde Nakit/Kart</span></p>
                        <p><strong>Fatura:</strong> <span id="invoice-status">Teslim sonrasÄ± verilecek</span></p>
                    </div>
                </div>
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #3498db;">
                    <p style="margin: 0; color: #2c3e50;"><strong>Not:</strong> Ã–deme araÃ§ teslim alÄ±nÄ±rken yapÄ±lacaktÄ±r. Nakit, kredi kartÄ± veya havale kabul edilmektedir.</p>
                </div>
            </section>

            <!-- Ä°letiÅŸim BÃ¶lÃ¼mÃ¼ -->
            <section style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); margin-top: 30px; border: 1px solid #ecf0f1;">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“ Ä°letiÅŸim</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div>
                        <h4>Tamirhane Ä°letiÅŸim</h4>
                        <p>ğŸ“ <strong>Telefon:</strong> (0212) 555 0123</p>
                        <p>ğŸ“§ <strong>E-posta:</strong> info@tamirhane.com</p>
                        <p>ğŸ“ <strong>Adres:</strong> Ã–rnek Cad. No:123, Ä°stanbul</p>
                    </div>
                    <div>
                        <h4>Mesai Saatleri</h4>
                        <p>ğŸ•˜ <strong>Hafta Ä°Ã§i:</strong> 08:00 - 18:00</p>
                        <p>ğŸ•’ <strong>Cumartesi:</strong> 09:00 - 15:00</p>
                        <p>ğŸš« <strong>Pazar:</strong> KapalÄ±</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <style>
        .process-timeline {
            position: relative;
            padding-left: 40px;
        }

        .process-timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #ecf0f1;
        }

        .process-step {
            position: relative;
            margin-bottom: 30px;
            padding-left: 40px;
        }

        .step-icon {
            position: absolute;
            left: -32px;
            top: 0;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            background: white;
            border: 2px solid #ecf0f1;
        }

        .process-step.completed .step-icon {
            background: #27ae60;
            border-color: #27ae60;
            color: white;
        }

        .process-step.active .step-icon {
            background: #3498db;
            border-color: #3498db;
            color: white;
            animation: pulse 2s infinite;
        }

        .process-step.pending .step-icon {
            background: #f8f9fa;
            border-color: #ecf0f1;
            color: #bdc3c7;
        }

        .step-content h4 {
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .step-content p {
            margin-bottom: 5px;
            font-weight: 600;
            color: #3498db;
        }

        .step-content small {
            color: #7f8c8d;
            line-height: 1.4;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(52, 152, 219, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(52, 152, 219, 0);
            }
        }
    </style>

    <script src="../js/auth.js"></script>
    <script src="../js/main.js"></script>
    <script>
        // Sayfa yÃ¼klendiÄŸinde gÃ¼venlik kontrolÃ¼ ve mÃ¼ÅŸteri bilgilerini al
        document.addEventListener('DOMContentLoaded', function() {
            // GiriÅŸ kontrolÃ¼
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            const userType = sessionStorage.getItem('userType');
            
            if (!isLoggedIn || userType !== 'customer') {
                showNotification('Bu sayfaya eriÅŸim iÃ§in mÃ¼ÅŸteri giriÅŸi yapmalÄ±sÄ±nÄ±z!', 'error');
                setTimeout(() => {
                    window.location.href = '../login.html';
                }, 2000);
                return;
            }
            
            // MÃ¼ÅŸteri verilerini yÃ¼kle
            const customerData = JSON.parse(sessionStorage.getItem('customerData'));
            if (customerData) {
                loadCustomerData(customerData);
            } else {
                showNotification('MÃ¼ÅŸteri verileri bulunamadÄ±!', 'error');
                setTimeout(() => {
                    window.location.href = '../login.html';
                }, 2000);
            }
        });

        function loadCustomerData(data) {
            try {
                // MÃ¼ÅŸteri ve araÃ§ bilgileri
                document.getElementById('customerName').textContent = `HoÅŸ geldiniz, ${data.customerName}!`;
                document.getElementById('tracking-number').textContent = data.trackingNumber;
                document.getElementById('register-date').textContent = data.vehicleData.registerDate;
                document.getElementById('customer-fullname').textContent = data.customerName;
                document.getElementById('customer-phone').textContent = data.phone;
                document.getElementById('customer-email').textContent = data.email || 'KayÄ±tlÄ± deÄŸil';
                
                // AraÃ§ bilgileri
                document.getElementById('vehicle-plate').textContent = data.vehicleData.plate;
                document.getElementById('vehicle-model').textContent = data.vehicleData.model;
                document.getElementById('vehicle-problem').textContent = data.vehicleData.problem;
                document.getElementById('arrival-date').textContent = data.vehicleData.arrivalDate;
                
                // Durum bilgileri
                document.getElementById('status-icon').textContent = data.vehicleData.statusIcon;
                document.getElementById('current-status').textContent = data.vehicleData.status;
                document.getElementById('last-update').textContent = data.vehicleData.lastUpdate;
                document.getElementById('current-operation').textContent = data.vehicleData.currentOperation;
                document.getElementById('estimated-delivery').textContent = data.vehicleData.estimatedDelivery;
                
                // Maliyet bilgileri
                document.getElementById('labor-cost').textContent = data.costData.laborCost;
                document.getElementById('parts-cost').textContent = data.costData.partsCost;
                document.getElementById('total-cost').textContent = data.costData.totalCost;
                document.getElementById('payment-status').textContent = data.costData.paymentStatus;
                document.getElementById('payment-method').textContent = data.costData.paymentMethod;
                
                // Durum rengini gÃ¼ncelle
                updateStatusColor(data.vehicleData.status);
                
                // BaÅŸarÄ±lÄ± yÃ¼kleme bildirimi
                showNotification(`${data.customerName}, araÃ§ bilgileriniz yÃ¼klendi!`, 'success');
                
            } catch (error) {
                console.error('Veri yÃ¼kleme hatasÄ±:', error);
                showNotification('Veri yÃ¼kleme sÄ±rasÄ±nda hata oluÅŸtu!', 'error');
            }
        }

        function updateStatusColor(status) {
            const statusElement = document.getElementById('current-status');
            const paymentStatusElement = document.getElementById('payment-status');
            
            switch(status) {
                case 'Beklemede':
                    statusElement.style.color = '#95a5a6';
                    break;
                case 'OnarÄ±mda':
                    statusElement.style.color = '#3498db';
                    break;
                case 'TamamlandÄ±':
                    statusElement.style.color = '#27ae60';
                    if (paymentStatusElement) {
                        paymentStatusElement.style.color = '#27ae60';
                    }
                    break;
                default:
                    statusElement.style.color = '#7f8c8d';
            }
        }

        // Otomatik yenileme (gerÃ§ek uygulamada WebSocket veya polling kullanÄ±lÄ±r)
        setInterval(function() {
            const statusElement = document.getElementById('last-update');
            if (statusElement) {
                const now = new Date();
                statusElement.textContent = `${now.toLocaleDateString('tr-TR')} - ${now.toLocaleTimeString('tr-TR', {hour: '2-digit', minute: '2-digit'})}`;
            }
        }, 60000); // Her dakika gÃ¼ncelle
    </script>
</body>
</html>
