<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YÃ¶netim Paneli - AraÃ§ Takip Sistemi</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header class="admin-header">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h1>âš™ï¸ YÃ¶netim Paneli</h1>
                <div>
                    <span id="adminUser">Admin KullanÄ±cÄ±</span>
                    <a href="../index.html" style="color: white; margin-left: 20px; text-decoration: none;">
                        ğŸ  Ana Sayfa
                    </a>
                    <a href="../login.html" style="color: white; margin-left: 10px; text-decoration: none;">
                        ğŸšª Ã‡Ä±kÄ±ÅŸ
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <nav class="admin-nav">
                <ul>
                    <li><a href="#arac-kabul" onclick="showSection('arac-kabul')">
                        <span>ğŸš—</span> AraÃ§ Kabul
                    </a></li>
                    <li><a href="#musteriler" onclick="showSection('musteriler')">
                        <span>ğŸ‘¥</span> MÃ¼ÅŸteri YÃ¶netimi
                    </a></li>
                    <li><a href="#bakim-kayitlari" onclick="showSection('bakim-kayitlari')">
                        <span>ğŸ”§</span> BakÄ±m KayÄ±tlarÄ±
                    </a></li>
                    <li><a href="#raporlar" onclick="showSection('raporlar')">
                        <span>ğŸ“Š</span> Raporlar
                    </a></li>
                    <li><a href="#kullanici-yonetimi" onclick="showSection('kullanici-yonetimi')">
                        <span>ğŸ‘¤</span> KullanÄ±cÄ± YÃ¶netimi
                    </a></li>
                    <li><a href="#ayarlar" onclick="showSection('ayarlar')">
                        <span>âš™ï¸</span> Ayarlar
                    </a></li>
                </ul>
            </nav>

            <!-- AraÃ§ Kabul BÃ¶lÃ¼mÃ¼ -->
            <section id="arac-kabul" class="admin-section">
                <h2>ğŸš— AraÃ§ KayÄ±t ve Kabul Ä°ÅŸlemleri</h2>
                <div class="admin-cards">
                    <div class="admin-card">
                        <h3>â• Yeni MÃ¼ÅŸteri & AraÃ§ KaydÄ±</h3>
                        <p>Yeni gelen mÃ¼ÅŸteriyi ve aracÄ±nÄ± sisteme kaydedin</p>
                        <button class="btn btn-primary" onclick="openNewRecordForm()">
                            ğŸ†• Yeni KayÄ±t OluÅŸtur
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>ğŸ“‹ GÃ¼nlÃ¼k KayÄ±tlar</h3>
                        <p id="daily-records">BugÃ¼n 3 yeni araÃ§ kaydedildi</p>
                        <button class="btn btn-admin" onclick="showDailyRecords()">
                            ğŸ“… BugÃ¼nkÃ¼ KayÄ±tlarÄ± GÃ¶r
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>ğŸ”„ HÄ±zlÄ± Durum DeÄŸiÅŸtir</h3>
                        <p>AraÃ§ durumlarÄ±nÄ± hÄ±zlÄ±ca gÃ¼ncelleyin</p>
                        <button class="btn btn-primary" onclick="openQuickStatusUpdate()">
                            âš¡ HÄ±zlÄ± GÃ¼ncelleme
                        </button>
                    </div>
                </div>

                <!-- Yeni KayÄ±t Formu (Gizli) -->
                <div id="newRecordForm" style="display: none; margin-top: 30px; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); border: 1px solid #ecf0f1;">
                    <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ†• Yeni AraÃ§ KaydÄ±</h3>
                    <form id="vehicleForm">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <!-- MÃ¼ÅŸteri Bilgileri -->
                            <div>
                                <h4 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">ğŸ‘¤ MÃ¼ÅŸteri Bilgileri</h4>
                                <div class="form-group">
                                    <label>Ad Soyad:</label>
                                    <input type="text" id="customerName" required style="width: 100%; padding: 10px; border: 1px solid #ecf0f1; border-radius: 5px;">
                                </div>
                                <div class="form-group">
                                    <label>Telefon:</label>
                                    <input type="tel" id="customerPhone" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                </div>
                                <div class="form-group">
                                    <label>E-posta (opsiyonel):</label>
                                    <input type="email" id="customerEmail" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                </div>
                            </div>
                            
                            <!-- AraÃ§ Bilgileri -->
                            <div>
                                <h4 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">ğŸš— AraÃ§ Bilgileri</h4>
                                <div class="form-group">
                                    <label>Plaka:</label>
                                    <input type="text" id="vehiclePlate" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; text-transform: uppercase;">
                                </div>
                                <div class="form-group">
                                    <label>Marka/Model:</label>
                                    <input type="text" id="vehicleModel" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                </div>
                                <div class="form-group">
                                    <label>Sorun/Ä°ÅŸlem:</label>
                                    <textarea id="vehicleProblem" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; height: 80px;"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; text-align: center;">
                            <button type="button" class="btn" style="background: #6c757d; color: white; margin-right: 10px;" onclick="cancelNewRecord()">
                                âŒ Ä°ptal
                            </button>
                            <button type="submit" class="btn btn-primary">
                                âœ… Kaydet ve Takip No OluÅŸtur
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- MÃ¼ÅŸteri YÃ¶netimi BÃ¶lÃ¼mÃ¼ -->
            <section id="musteriler" class="admin-section" style="display: none;">
                <h2>ğŸ‘¥ MÃ¼ÅŸteri ve AraÃ§ YÃ¶netimi</h2>
                <div class="admin-cards">
                    <div class="admin-card">
                        <h3>ğŸ” MÃ¼ÅŸteri/AraÃ§ Arama</h3>
                        <input type="text" id="searchInput" placeholder="Ä°sim, telefon, plaka veya takip no..." style="width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <button class="btn btn-primary" style="width: 100%;" onclick="searchCustomers()">
                            ğŸ” Ara
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>ğŸ“Š TÃ¼m KayÄ±tlar</h3>
                        <p>Sistemdeki tÃ¼m mÃ¼ÅŸteri ve araÃ§ kayÄ±tlarÄ±</p>
                        <button class="btn btn-admin" onclick="showAllRecords()">
                            ğŸ“‹ TÃ¼m KayÄ±tlarÄ± Listele
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>âœï¸ Bilgi GÃ¼ncelleme</h3>
                        <p>MÃ¼ÅŸteri bilgilerini gÃ¼ncelleyin</p>
                        <button class="btn btn-primary" onclick="showUpdateForm()">
                            âœï¸ Bilgi GÃ¼ncelle
                        </button>
                    </div>
                </div>

                <!-- Arama SonuÃ§larÄ± -->
                <div id="searchResults" style="display: none; margin-top: 30px;">
                    <h3 style="color: #667eea;">Arama SonuÃ§larÄ±</h3>
                    <div id="resultsContainer"></div>
                </div>
            </section>

            <!-- AraÃ§ Durum YÃ¶netimi BÃ¶lÃ¼mÃ¼ -->
            <section id="bakim-kayitlari" class="admin-section" style="display: none;">
                <h2>ğŸ”§ AraÃ§ Durum YÃ¶netimi</h2>
                <div class="admin-cards">
                    <div class="admin-card">
                        <h3>â³ Beklemede Olanlar</h3>
                        <p id="waiting-count">2 araÃ§ beklemede</p>
                        <button class="btn btn-primary" onclick="showWaitingVehicles()">
                            ğŸ“‹ Bekleyenleri Listele
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>ğŸ”§ OnarÄ±mda Olanlar</h3>
                        <p id="repair-count">3 araÃ§ onarÄ±mda</p>
                        <button class="btn btn-admin" onclick="showRepairVehicles()">
                            ğŸ”§ OnarÄ±mdakileri Listele
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>âœ… Tamamlananlar</h3>
                        <p id="completed-count">Bu hafta 8 araÃ§ tamamlandÄ±</p>
                        <button class="btn btn-primary" onclick="showCompletedVehicles()">
                            âœ… TamamlananlarÄ± Listele
                        </button>
                    </div>
                </div>

                <!-- Durum DeÄŸiÅŸtirme Paneli -->
                <div id="statusChangePanel" style="display: none; margin-top: 30px; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);">
                    <h3 style="color: #667eea; margin-bottom: 20px;">ğŸ”„ AraÃ§ Durumu DeÄŸiÅŸtir</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <button class="btn" style="background: #ff9800; color: white;" onclick="changeStatus('Beklemede')">
                            â³ Beklemede Yap
                        </button>
                        <button class="btn" style="background: #2196F3; color: white;" onclick="changeStatus('OnarÄ±mda')">
                            ğŸ”§ OnarÄ±mda Yap
                        </button>
                        <button class="btn" style="background: #4CAF50; color: white;" onclick="changeStatus('TamamlandÄ±')">
                            âœ… TamamlandÄ± Yap
                        </button>
                    </div>
                </div>
            </section>

            <!-- Raporlar BÃ¶lÃ¼mÃ¼ -->
            <section id="raporlar" class="admin-section" style="display: none;">
                <h2>ğŸ“Š Raporlar ve Ä°statistikler</h2>
                <div class="admin-cards">
                    <div class="admin-card">
                        <h3>GÃ¼nlÃ¼k Rapor</h3>
                        <p>BugÃ¼nkÃ¼ iÅŸlem Ã¶zeti</p>
                        <button class="btn btn-primary">
                            Raporu OluÅŸtur
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>AylÄ±k Ä°statistik</h3>
                        <p>Bu ay yapÄ±lan iÅŸlemler</p>
                        <button class="btn btn-admin">
                            Ä°statistikleri GÃ¶ster
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>Gelir Raporu</h3>
                        <p>Finansal durum raporu</p>
                        <button class="btn btn-primary">
                            Gelir Raporunu GÃ¶ster
                        </button>
                    </div>
                </div>
            </section>

            <!-- KullanÄ±cÄ± YÃ¶netimi BÃ¶lÃ¼mÃ¼ -->
            <section id="kullanici-yonetimi" class="admin-section" style="display: none;">
                <h2>ğŸ‘¤ KullanÄ±cÄ± YÃ¶netimi</h2>
                <div class="admin-cards">
                    <div class="admin-card">
                        <h3>Aktif KullanÄ±cÄ±lar</h3>
                        <p>Sisteme kayÄ±tlÄ± kullanÄ±cÄ±lar</p>
                        <button class="btn btn-primary">
                            KullanÄ±cÄ±larÄ± Listele
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>Yeni KullanÄ±cÄ±</h3>
                        <p>Sisteme yeni kullanÄ±cÄ± ekleyin</p>
                        <button class="btn btn-admin">
                            KullanÄ±cÄ± Ekle
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>Åifre SÄ±fÄ±rlama</h3>
                        <p>KullanÄ±cÄ± ÅŸifrelerini sÄ±fÄ±rlayÄ±n</p>
                        <button class="btn btn-primary">
                            Åifre Ä°ÅŸlemleri
                        </button>
                    </div>
                </div>
            </section>

            <!-- Ayarlar BÃ¶lÃ¼mÃ¼ -->
            <section id="ayarlar" class="admin-section" style="display: none;">
                <h2>âš™ï¸ Sistem AyarlarÄ±</h2>
                <div class="admin-cards">
                    <div class="admin-card">
                        <h3>Genel Ayarlar</h3>
                        <p>Sistem genel yapÄ±landÄ±rmasÄ±</p>
                        <button class="btn btn-primary">
                            AyarlarÄ± DÃ¼zenle
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>Tema AyarlarÄ±</h3>
                        <p>GÃ¶rÃ¼nÃ¼m ve tema ayarlarÄ±</p>
                        <button class="btn btn-admin">
                            Tema DeÄŸiÅŸtir
                        </button>
                    </div>
                    <div class="admin-card">
                        <h3>Yedekleme</h3>
                        <p>Veri yedekleme iÅŸlemleri</p>
                        <button class="btn btn-primary">
                            Yedek Al
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script>
        // Sayfa yÃ¼klendiÄŸinde gÃ¼venlik kontrolÃ¼
        document.addEventListener('DOMContentLoaded', function() {
            // GiriÅŸ kontrolÃ¼
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            const userType = sessionStorage.getItem('userType');
            const username = sessionStorage.getItem('username');
            
            if (!isLoggedIn || userType !== 'admin') {
                showNotification('Bu sayfaya eriÅŸim iÃ§in admin giriÅŸi yapmalÄ±sÄ±nÄ±z!', 'error');
                setTimeout(() => {
                    window.location.href = '../login.html';
                }, 2000);
                return;
            }
            
            document.getElementById('adminUser').textContent = `HoÅŸ geldiniz, ${username}`;
            showSection('arac-kabul');
            
            // Form event listener'Ä± ekle
            const vehicleForm = document.getElementById('vehicleForm');
            if (vehicleForm) {
                vehicleForm.addEventListener('submit', handleNewVehicleSubmit);
            }
            
            // GÃ¼nlÃ¼k kayÄ±t sayÄ±sÄ±nÄ± gÃ¼ncelle
            updateDailyRecordCount();
            
            // Durum sayÄ±larÄ±nÄ± gÃ¼ncelle
            updateStatusCounts();
        });

        function showSection(sectionId) {
            // TÃ¼m bÃ¶lÃ¼mleri gizle
            const sections = document.querySelectorAll('.admin-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            
            // SeÃ§ilen bÃ¶lÃ¼mÃ¼ gÃ¶ster
            document.getElementById(sectionId).style.display = 'block';
            
            // Aktif menÃ¼ Ã¶ÄŸesini iÅŸaretle
            const navLinks = document.querySelectorAll('.admin-nav a');
            navLinks.forEach(link => {
                link.style.background = '#f8f9fa';
                link.style.color = '#333';
            });
            
            const activeLink = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (activeLink) {
                activeLink.style.background = '#667eea';
                activeLink.style.color = 'white';
            }
        }

        // Yeni kayÄ±t formu fonksiyonlarÄ±
        function openNewRecordForm() {
            document.getElementById('newRecordForm').style.display = 'block';
            document.getElementById('customerName').focus();
        }

        function cancelNewRecord() {
            document.getElementById('newRecordForm').style.display = 'none';
            document.getElementById('vehicleForm').reset();
        }

        function handleNewVehicleSubmit(e) {
            e.preventDefault();
            
            const formData = {
                customerName: document.getElementById('customerName').value,
                customerPhone: document.getElementById('customerPhone').value,
                customerEmail: document.getElementById('customerEmail').value || '',
                vehiclePlate: document.getElementById('vehiclePlate').value.toUpperCase(),
                vehicleModel: document.getElementById('vehicleModel').value,
                vehicleProblem: document.getElementById('vehicleProblem').value,
                trackingNumber: generateTrackingNumber(),
                registerDate: new Date().toLocaleDateString('tr-TR'),
                status: 'Beklemede'
            };
            
            // LocalStorage'a kaydet (gerÃ§ek uygulamada backend'e gÃ¶nderilir)
            saveVehicleRecord(formData);
            
            showNotification(`âœ… KayÄ±t baÅŸarÄ±lÄ±! Takip No: ${formData.trackingNumber}`, 'success');
            cancelNewRecord();
            
            // SayÄ±larÄ± gÃ¼ncelle
            updateDailyRecordCount();
            updateStatusCounts();
            
            // Takip numarasÄ±nÄ± gÃ¶ster
            setTimeout(() => {
                alert(`MÃ¼ÅŸteriye verilecek takip numarasÄ±:\n\n${formData.trackingNumber}\n\nMÃ¼ÅŸteri bu numara ile araÃ§ durumunu sorgulayabilir.`);
            }, 1000);
        }

        function generateTrackingNumber() {
            const year = new Date().getFullYear();
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `TK${year}${random}`;
        }

        function saveVehicleRecord(data) {
            // LocalStorage'dan mevcut kayÄ±tlarÄ± al
            let records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            
            // Yeni kaydÄ± ekle
            records.push({
                ...data,
                id: Date.now(),
                createdAt: new Date().toISOString()
            });
            
            // Kaydet
            localStorage.setItem('vehicleRecords', JSON.stringify(records));
        }

        // Arama fonksiyonlarÄ±
        function searchCustomers() {
            const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
            if (!searchTerm) {
                showNotification('Arama terimi girin!', 'error');
                return;
            }
            
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const results = records.filter(record => 
                record.customerName.toLowerCase().includes(searchTerm) ||
                record.customerPhone.includes(searchTerm) ||
                record.vehiclePlate.toLowerCase().includes(searchTerm) ||
                record.trackingNumber.toLowerCase().includes(searchTerm)
            );
            
            displaySearchResults(results);
        }

        function displaySearchResults(results) {
            const container = document.getElementById('resultsContainer');
            const resultsDiv = document.getElementById('searchResults');
            
            if (results.length === 0) {
                container.innerHTML = '<p style="color: #7f8c8d; text-align: center; padding: 20px;">Arama kriterinize uygun kayÄ±t bulunamadÄ±.</p>';
            } else {
                container.innerHTML = results.map(record => {
                    const statusColor = getStatusColor(record.status);
                    const createdDate = new Date(record.createdAt).toLocaleDateString('tr-TR');
                    const createdTime = new Date(record.createdAt).toLocaleTimeString('tr-TR', {hour: '2-digit', minute: '2-digit'});
                    
                    return `
                        <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #ecf0f1; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                                <div>
                                    <h4 style="color: #2c3e50; margin-bottom: 10px; font-size: 1.2rem;">ğŸ‘¤ ${record.customerName}</h4>
                                    <p style="margin: 5px 0; color: #7f8c8d;"><strong>ğŸ“ Telefon:</strong> ${record.customerPhone}</p>
                                    <p style="margin: 5px 0; color: #7f8c8d;"><strong>ğŸ“§ E-posta:</strong> ${record.customerEmail || 'BelirtilmemiÅŸ'}</p>
                                    <p style="margin: 5px 0; color: #7f8c8d;"><strong>ğŸ“‹ Takip No:</strong> <span style="color: #3498db; font-weight: bold;">${record.trackingNumber}</span></p>
                                </div>
                                <div>
                                    <h4 style="color: #2c3e50; margin-bottom: 10px; font-size: 1.2rem;">ğŸš— ${record.vehiclePlate}</h4>
                                    <p style="margin: 5px 0; color: #7f8c8d;"><strong>ğŸš™ Model:</strong> ${record.vehicleModel}</p>
                                    <p style="margin: 5px 0; color: #7f8c8d;"><strong>ğŸ“… KayÄ±t:</strong> ${record.registerDate} ${createdTime}</p>
                                    <p style="margin: 5px 0;"><strong>ğŸ“Š Durum:</strong> <span style="color: ${statusColor}; font-weight: bold; padding: 4px 8px; border-radius: 4px; background: ${statusColor}20;">${record.status}</span></p>
                                </div>
                            </div>
                            <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 6px;">
                                <p style="margin: 0; color: #2c3e50;"><strong>ğŸ”§ Sorun/Ä°ÅŸlem:</strong> ${record.vehicleProblem}</p>
                            </div>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="editRecord(${record.id})" style="padding: 8px 16px; font-size: 0.9rem;">
                                    âœï¸ DÃ¼zenle
                                </button>
                                <button class="btn btn-admin" onclick="changeRecordStatus(${record.id})" style="padding: 8px 16px; font-size: 0.9rem;">
                                    ğŸ”„ Durum DeÄŸiÅŸtir
                                </button>
                                <button class="btn" onclick="viewRecordDetails(${record.id})" style="background: #95a5a6; color: white; padding: 8px 16px; font-size: 0.9rem;">
                                    ğŸ‘ï¸ Detay GÃ¶rÃ¼ntÃ¼le
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            resultsDiv.style.display = 'block';
            
            // SonuÃ§lar bÃ¶lÃ¼mÃ¼ne yumuÅŸak scroll
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function getStatusColor(status) {
            switch(status) {
                case 'Beklemede': return '#95a5a6';
                case 'OnarÄ±mda': return '#3498db';
                case 'TamamlandÄ±': return '#27ae60';
                default: return '#7f8c8d';
            }
        }

        function viewRecordDetails(recordId) {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const record = records.find(r => r.id === recordId);
            
            if (record) {
                const details = `
                    ğŸš— ARAÃ‡ BÄ°LGÄ°LERÄ°
                    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    MÃ¼ÅŸteri: ${record.customerName}
                    Telefon: ${record.customerPhone}
                    E-posta: ${record.customerEmail || 'BelirtilmemiÅŸ'}
                    
                    Plaka: ${record.vehiclePlate}
                    Model: ${record.vehicleModel}
                    Sorun: ${record.vehicleProblem}
                    
                    Takip No: ${record.trackingNumber}
                    KayÄ±t Tarihi: ${record.registerDate}
                    Durum: ${record.status}
                    
                    Son GÃ¼ncelleme: ${record.lastUpdate || 'HenÃ¼z gÃ¼ncelleme yapÄ±lmamÄ±ÅŸ'}
                `;
                alert(details);
            }
        }

        function showAllRecords() {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            
            if (records.length === 0) {
                // EÄŸer hiÃ§ kayÄ±t yoksa demo veriler gÃ¶ster
                const demoRecords = [
                    {
                        id: Date.now() + 1,
                        customerName: "Kamil Kamil",
                        customerPhone: "05555555555",
                        customerEmail: "kamil@email.com",
                        vehiclePlate: "25 FAF 25",
                        vehicleModel: "Chery Tiggo 8",
                        vehicleProblem: "HasarlÄ±",
                        trackingNumber: "TK2025636",
                        registerDate: "20.09.2025",
                        status: "Beklemede",
                        createdAt: new Date(Date.now() - 86400000).toISOString() // 1 gÃ¼n Ã¶nce
                    },
                    {
                        id: Date.now() + 2,
                        customerName: "Mehmet Ã–ztÃ¼rk",
                        customerPhone: "05559876543",
                        customerEmail: "mehmet@email.com",
                        vehiclePlate: "06 DEF 456",
                        vehicleModel: "Volkswagen Passat 2019",
                        vehicleProblem: "Klima bakÄ±mÄ± ve filter deÄŸiÅŸimi",
                        trackingNumber: "TK2025003",
                        registerDate: new Date().toLocaleDateString('tr-TR'),
                        status: "OnarÄ±mda",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: Date.now() + 3,
                        customerName: "AyÅŸe Kaya",
                        customerPhone: "05551112233",
                        customerEmail: "ayse@email.com",
                        vehiclePlate: "34 GHI 789",
                        vehicleModel: "Renault Megane 2020",
                        vehicleProblem: "Motor kontrolÃ¼ ve genel bakÄ±m",
                        trackingNumber: "TK2025004",
                        registerDate: new Date().toLocaleDateString('tr-TR'),
                        status: "OnarÄ±mda",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: Date.now() + 4,
                        customerName: "Can Demir",
                        customerPhone: "05554445566",
                        customerEmail: "can@email.com",
                        vehiclePlate: "35 JKL 012",
                        vehicleModel: "Ford Focus 2018",
                        vehicleProblem: "Lastik deÄŸiÅŸimi ve balans ayarÄ±",
                        trackingNumber: "TK2025005",
                        registerDate: new Date().toLocaleDateString('tr-TR'),
                        status: "TamamlandÄ±",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: Date.now() + 5,
                        customerName: "Fatma Demir",
                        customerPhone: "05559876543",
                        customerEmail: "fatma@email.com",
                        vehiclePlate: "35 XYZ 789",
                        vehicleModel: "Toyota Corolla 2020",
                        vehicleProblem: "Motor yaÄŸ deÄŸiÅŸimi",
                        trackingNumber: "TK2025002",
                        registerDate: "19.09.2025",
                        status: "TamamlandÄ±",
                        createdAt: new Date(Date.now() - 172800000).toISOString() // 2 gÃ¼n Ã¶nce
                    },
                    {
                        id: Date.now() + 6,
                        customerName: "Ali YÄ±lmaz",
                        customerPhone: "05557778899",
                        customerEmail: "ali@email.com",
                        vehiclePlate: "16 MNO 345",
                        vehicleModel: "Hyundai i20 2021",
                        vehicleProblem: "Fren sistemi bakÄ±mÄ±",
                        trackingNumber: "TK2025007",
                        registerDate: "18.09.2025",
                        status: "Beklemede",
                        createdAt: new Date(Date.now() - 259200000).toISOString() // 3 gÃ¼n Ã¶nce
                    }
                ];
                
                displaySearchResults(demoRecords);
                showNotification(`Sistemde toplam ${demoRecords.length} kayÄ±t var (demo veriler)`, 'info');
            } else {
                // KayÄ±tlarÄ± tarihe gÃ¶re sÄ±rala (en yeni Ã¶nce)
                const sortedRecords = records.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                displaySearchResults(sortedRecords);
                showNotification(`Sistemde toplam ${records.length} kayÄ±t listelendi`, 'success');
            }
        }

        // Durum deÄŸiÅŸtirme fonksiyonlarÄ±
        function showWaitingVehicles() {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const waiting = records.filter(r => r.status === 'Beklemede');
            displaySearchResults(waiting);
        }

        function showRepairVehicles() {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const repair = records.filter(r => r.status === 'OnarÄ±mda');
            displaySearchResults(repair);
        }

        function showCompletedVehicles() {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const completed = records.filter(r => r.status === 'TamamlandÄ±');
            displaySearchResults(completed);
        }

        function changeRecordStatus(recordId) {
            const newStatus = prompt('Yeni durumu seÃ§in:\n1 - Beklemede\n2 - OnarÄ±mda\n3 - TamamlandÄ±');
            
            const statusMap = {
                '1': 'Beklemede',
                '2': 'OnarÄ±mda', 
                '3': 'TamamlandÄ±'
            };
            
            if (statusMap[newStatus]) {
                updateRecordStatus(recordId, statusMap[newStatus]);
                showNotification(`Durum ${statusMap[newStatus]} olarak gÃ¼ncellendi!`, 'success');
                showAllRecords(); // Listeyi yenile
            }
        }

        function updateRecordStatus(recordId, newStatus) {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const recordIndex = records.findIndex(r => r.id === recordId);
            
            if (recordIndex !== -1) {
                records[recordIndex].status = newStatus;
                records[recordIndex].lastUpdate = new Date().toISOString();
                localStorage.setItem('vehicleRecords', JSON.stringify(records));
            }
        }

        // Placeholder fonksiyonlar
        function openQuickStatusUpdate() {
            showNotification('HÄ±zlÄ± durum gÃ¼ncelleme - GeliÅŸtirme aÅŸamasÄ±nda', 'info');
        }

        function showDailyRecords() {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const today = new Date().toLocaleDateString('tr-TR');
            const todayRecords = records.filter(r => r.registerDate === today);
            
            if (todayRecords.length === 0) {
                // EÄŸer bugÃ¼nkÃ¼ kayÄ±t yoksa demo veriler gÃ¶ster
                const demoTodayRecords = [
                    {
                        id: Date.now() + 1,
                        customerName: "Mehmet Ã–ztÃ¼rk",
                        customerPhone: "05559876543",
                        vehiclePlate: "06 DEF 456",
                        vehicleModel: "Volkswagen Passat 2019",
                        vehicleProblem: "Klima bakÄ±mÄ± ve filter deÄŸiÅŸimi",
                        trackingNumber: "TK2025003",
                        registerDate: today,
                        status: "Beklemede",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: Date.now() + 2,
                        customerName: "AyÅŸe Kaya",
                        customerPhone: "05551112233",
                        vehiclePlate: "34 GHI 789",
                        vehicleModel: "Renault Megane 2020",
                        vehicleProblem: "Motor kontrolÃ¼ ve genel bakÄ±m",
                        trackingNumber: "TK2025004",
                        registerDate: today,
                        status: "OnarÄ±mda",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: Date.now() + 3,
                        customerName: "Can Demir",
                        customerPhone: "05554445566",
                        vehiclePlate: "35 JKL 012",
                        vehicleModel: "Ford Focus 2018",
                        vehicleProblem: "Lastik deÄŸiÅŸimi ve balans ayarÄ±",
                        trackingNumber: "TK2025005",
                        registerDate: today,
                        status: "TamamlandÄ±",
                        createdAt: new Date().toISOString()
                    }
                ];
                displaySearchResults(demoTodayRecords);
                showNotification(`BugÃ¼n ${demoTodayRecords.length} araÃ§ kaydÄ± var (demo veriler)`, 'info');
            } else {
                displaySearchResults(todayRecords);
                showNotification(`BugÃ¼n ${todayRecords.length} araÃ§ kaydedildi`, 'success');
            }
            
            // MÃ¼ÅŸteri yÃ¶netimi bÃ¶lÃ¼mÃ¼ne geÃ§
            showSection('musteriler');
            
            // GÃ¼nlÃ¼k kayÄ±t sayÄ±sÄ±nÄ± gÃ¼ncelle
            updateDailyRecordCount();
        }

        function updateStatusCounts() {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            
            // Demo veriler ekle eÄŸer hiÃ§ kayÄ±t yoksa
            if (records.length === 0) {
                const waitingCount = 2;
                const repairCount = 3; 
                const completedCount = 8;
                
                const waitingElement = document.getElementById('waiting-count');
                const repairElement = document.getElementById('repair-count');
                const completedElement = document.getElementById('completed-count');
                
                if (waitingElement) waitingElement.textContent = `${waitingCount} araÃ§ beklemede (demo)`;
                if (repairElement) repairElement.textContent = `${repairCount} araÃ§ onarÄ±mda (demo)`;
                if (completedElement) completedElement.textContent = `Bu hafta ${completedCount} araÃ§ tamamlandÄ± (demo)`;
            } else {
                const waitingCount = records.filter(r => r.status === 'Beklemede').length;
                const repairCount = records.filter(r => r.status === 'OnarÄ±mda').length;
                
                // Tamamlanan araÃ§lar iÃ§in son 7 gÃ¼n
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                const completedCount = records.filter(r => {
                    if (r.status === 'TamamlandÄ±' && r.lastUpdate) {
                        const updateDate = new Date(r.lastUpdate);
                        return updateDate >= weekAgo;
                    }
                    return false;
                }).length;
                
                const waitingElement = document.getElementById('waiting-count');
                const repairElement = document.getElementById('repair-count');
                const completedElement = document.getElementById('completed-count');
                
                if (waitingElement) waitingElement.textContent = `${waitingCount} araÃ§ beklemede`;
                if (repairElement) repairElement.textContent = `${repairCount} araÃ§ onarÄ±mda`;
                if (completedElement) completedElement.textContent = `Bu hafta ${completedCount} araÃ§ tamamlandÄ±`;
            }
        }

        function updateDailyRecordCount() {
            const records = JSON.parse(localStorage.getItem('vehicleRecords') || '[]');
            const today = new Date().toLocaleDateString('tr-TR');
            const todayCount = records.filter(r => r.registerDate === today).length;
            
            const dailyRecordsElement = document.getElementById('daily-records');
            if (dailyRecordsElement) {
                if (todayCount === 0) {
                    dailyRecordsElement.textContent = 'BugÃ¼n 3 yeni araÃ§ kaydedildi (demo)';
                } else {
                    dailyRecordsElement.textContent = `BugÃ¼n ${todayCount} yeni araÃ§ kaydedildi`;
                }
            }
        }

        function showUpdateForm() {
            showNotification('Bilgi gÃ¼ncelleme formu - GeliÅŸtirme aÅŸamasÄ±nda', 'info');
        }

        function editRecord(recordId) {
            showNotification('KayÄ±t dÃ¼zenleme - GeliÅŸtirme aÅŸamasÄ±nda', 'info');
        }
    </script>
    <script src="../js/auth.js"></script>
    <script src="../js/main.js"></script>
</body>
</html>
